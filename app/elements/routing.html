<script src="../bower_components/page/page.js"></script>
<script>
window.addEventListener('WebComponentsReady', function() {
  // Middleware
  function scrollToTop(ctx, next) {
    app.scrollPageToTop();
    next();
  }

  // Routes.
  page('/', function() {
    page.redirect('/q/status:open');
  });

  function queryHandler(data) {
    app.route = 'gr-change-list';
    app.params = data.params;
  }

  page('/q/:query,:offset', scrollToTop, queryHandler);
  page('/q/:query', scrollToTop, queryHandler);

  page('/c/:changeID', scrollToTop, function(data) {
    app.route = 'gr-change-view';
    app.params = data.params;
  });

  page('/c/:changeID/:patchSetNum', scrollToTop, function(data) {
    app.route = 'gr-diff';
    app.params = data.params;
  });

  // Start.
  page();
});
</script>
